<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soul of Africa - Find Your Connection</title>
    
    <!-- External CSS Libraries -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Your Custom CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body class="text-gray-200 font-sans min-h-screen flex flex-col relative">

    <!-- Offline Overlay -->
    <div class="offline-overlay" id="offlineOverlay">
        <div class="offline-icon">
            <i class="fas fa-wifi"></i>
        </div>
        <div class="offline-text">You are offline</div>
        <div class="offline-subtext">Please check your internet connection and try again</div>
    </div>

    <!-- Africa Map Background -->
    <div class="africa-map-bg" id="africaMapBg"></div>

    <!-- Square Column Table Lamp with click feedback -->
    <div class="lamp-container" id="touchLamp" title="Pull rope to toggle light">
        <div class="click-feedback" id="clickFeedback"></div>
        
        <!-- Lamp Shade -->
        <div class="lamp-shade-square">
            <div class="bulb-glow" id="bulbGlow"></div>
        </div>
        
        <!-- Column Body -->
        <div class="lamp-column">
            <div class="lamp-inner-light" id="innerLight"></div>
        </div>
        
        <!-- Base -->
        <div class="lamp-base-square"></div>
        
        <!-- Rope Switch -->
        <div class="rope-switch-container" id="ropeSwitchContainer">
            <div class="rope-base"></div>
            <div class="rope" id="ropeSwitch">
                <div class="rope-knob"></div>
            </div>
        </div>
    </div>

    <div id="lamp-light"></div>
    <div id="darkness-overlay"></div>

    <!-- Dark Welcome -->
    <div id="dark-welcome">
        <div class="text-center space-y-6 p-6">
            <h1 class="text-5xl md:text-7xl font-serif font-bold glow-text tracking-widest uppercase">Welcome</h1>
            <p class="text-lg md:text-xl font-light text-gray-500 tracking-wide max-w-md mx-auto leading-relaxed">
                It is dark in here.<br>
                <span class="text-yellow-700 font-semibold">Pull the rope switch</span> to illuminate your journey.
            </p>
        </div>
    </div>

    <!-- Auth Interface -->
    <div id="interface-container" class="relative z-20 flex-grow flex items-center justify-center p-4">
        <div class="auth-container">
            <div class="auth-title">AfriConnect</div>
            
            <div class="auth-tabs">
                <div class="auth-tab active" onclick="switchAuthTab('login')">Login</div>
                <div class="auth-tab" onclick="switchAuthTab('signup')">Sign Up</div>
            </div>

            <!-- Login Form -->
            <form id="loginForm" class="auth-form active" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="loginUsername" placeholder="Enter your username" required autocomplete="username">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter your password" required autocomplete="current-password">
                </div>
                <button type="submit" class="auth-btn">ENTER THE LIGHT</button>
                <div class="auth-error" id="loginError"></div>
            </form>

            <!-- Signup Form -->
            <form id="signupForm" class="auth-form" onsubmit="handleSignup(event)">
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="signupUsername" placeholder="Choose a username" required autocomplete="username">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="signupPassword" placeholder="Create a password" required autocomplete="new-password">
                </div>
                <button type="submit" class="auth-btn">BEGIN JOURNEY</button>
                <div class="auth-error" id="signupError"></div>
                <div class="auth-success" id="signupSuccess"></div>
            </form>
        </div>
    </div>

    <!-- MAIN APP INTERFACE -->
    <div id="swipe-interface">
        <!-- Top Bar -->
        <div class="flex justify-between items-center p-4 bg-black/50 backdrop-blur-sm border-b border-white/10">
            <div class="logo-container">
                <img src="https://static.vecteezy.com/system/resources/previews/006/580/686/non_2x/map-of-africa-on-black-background-vector.jpg" class="logo-image" style="width: 32px; height: 32px;" alt="AfriConnect Logo">
                <span class="font-serif font-bold text-yellow-500 text-lg">AfriConnect</span>
            </div>
            <div class="flex items-center gap-4">
                <button onclick="toggleNotifications()" class="relative text-gray-400 hover:text-white">
                    <i class="fas fa-bell text-xl"></i>
                    <span id="notifBadge" class="absolute -top-1 -right-1 w-4 h-4 bg-red-500 rounded-full text-xs flex items-center justify-center hidden">0</span>
                </button>
                <button onclick="logout()" class="text-sm text-gray-400 hover:text-white">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>

        <!-- Search Container -->
        <div class="search-container">
            <div class="search-bar">
                <i class="fas fa-search text-gray-400"></i>
                <input type="text" id="userSearchInput" placeholder="Search for users to add as friends..." onkeyup="searchUsers(this.value)">
            </div>
            <div class="search-results" id="searchResults"></div>
        </div>

        <!-- NOTIFICATION PANEL -->
        <div class="notification-panel" id="notificationPanel">
            <div class="notification-header">
                <span class="notification-title">Notifications</span>
                <span class="notification-count" id="notifCount">0 new</span>
            </div>
            <div class="notification-list" id="notificationList"></div>
            <div class="mark-all-read" onclick="markAllNotificationsRead()">
                Mark all as read
            </div>
        </div>

        <!-- MAIN MENU BUTTON -->
        <div class="main-menu-btn" onclick="toggleMainMenu()">
            <i class="fas fa-bars"></i>
        </div>

        <!-- MAIN MENU OVERLAY -->
        <div class="main-menu-overlay" id="mainMenuOverlay" onclick="toggleMainMenu()"></div>

        <!-- MAIN MENU PANEL -->
        <div class="main-menu-panel" id="mainMenuPanel">
            <div class="main-menu-header">
                <div class="main-menu-user">
                    <img src="" class="main-menu-avatar" id="menuUserAvatar" alt="User">
                    <div class="main-menu-user-info">
                        <h3 id="menuUserName">User</h3>
                        <p>Member</p>
                    </div>
                </div>
            </div>
            
            <div class="main-menu-items">
                <div class="main-menu-section-title">Menu</div>
                
                <div class="main-menu-item" onclick="showSectionFromMenu('market')">
                    <i class="fas fa-store"></i>
                    <span>African Market Zone</span>
                </div>
                
                <div class="main-menu-item" onclick="showSectionFromMenu('groups')">
                    <i class="fas fa-users"></i>
                    <span>Community Groups</span>
                </div>
                
                <div class="main-menu-item" onclick="showSectionFromMenu('profile')">
                    <i class="fas fa-user"></i>
                    <span>My Profile</span>
                </div>

                <div class="main-menu-divider"></div>
                
                <div class="main-menu-section-title">Market</div>
                
                <div class="main-menu-item" onclick="showMyAdverts()">
                    <i class="fas fa-bullhorn"></i>
                    <span>My Adverts</span>
                </div>
                
                <div class="main-menu-item" onclick="openCreateAdvert()">
                    <i class="fas fa-plus-circle"></i>
                    <span>Create Advert</span>
                </div>

                <div class="main-menu-divider"></div>
                
                <div class="main-menu-section-title">Support</div>
                
                <div class="main-menu-item" onclick="showHelp()">
                    <i class="fas fa-question-circle"></i>
                    <span>Help & Support</span>
                </div>
                
                <div class="main-menu-item" onclick="logout()">
                    <i class="fas fa-sign-out-alt" style="color: #ef4444;"></i>
                    <span style="color: #ef4444;">Logout</span>
                </div>
            </div>
        </div>

        <!-- ENIOLA BOT -->
        <div class="eniola-bot" onclick="toggleEniola()" title="Chat with ENIOLA">
            <i class="fas fa-robot"></i>
        </div>

        <!-- ENIOLA CHAT -->
        <div class="eniola-chat" id="eniolaChat">
            <div class="eniola-header">
                <div class="eniola-avatar">ü§ñ</div>
                <div>
                    <div class="eniola-name">ENIOLA</div>
                    <div class="eniola-status">‚óè Online</div>
                </div>
                <i class="fas fa-times eniola-close" onclick="toggleEniola()"></i>
            </div>
            <div class="eniola-messages" id="eniolaMessages">
                <div class="eniola-message">
                    Hello! I'm ENIOLA, your AfriConnect assistant. Welcome! How can I help you today?
                </div>
            </div>
            <div class="eniola-options" id="eniolaOptions">
                <div class="eniola-option" onclick="askEniola('how')">How does this work?</div>
                <div class="eniola-option" onclick="askEniola('discover')">How to find matches?</div>
                <div class="eniola-option" onclick="askEniola('market')">About Marketplace</div>
                <div class="eniola-option" onclick="askEniola('groups')">Community Groups</div>
                <div class="eniola-option" onclick="askEniola('safety')">Safety Tips</div>
            </div>
        </div>

        <!-- DISCOVERY SECTION -->
        <div id="section-swipe" class="app-section active">
            <div class="p-3 border-b border-white/10 flex justify-between items-center">
                <div>
                    <h2 class="text-lg font-bold text-white">Discover</h2>
                    <p class="text-xs text-gray-400">Find your perfect match</p>
                </div>
                <select onchange="filterDiscovery(this.value)" class="text-xs">
                    <option value="all">All</option>
                    <option value="male">Men</option>
                    <option value="female">Women</option>
                    <option value="verified">Verified Only</option>
                </select>
            </div>
            <div class="discovery-grid" id="discoveryGrid"></div>
        </div>

        <!-- NEARBY SECTION -->
        <div id="section-nearby" class="app-section">
            <div class="nearby-toggle">
                <div class="nearby-status"></div>
                <div class="flex-1">
                    <div class="font-bold text-white text-sm">Nearby Active</div>
                    <div class="text-xs text-gray-400">People within 5 km can see you</div>
                </div>
                <div class="toggle-switch active" onclick="toggleNearby(this)"></div>
            </div>
            <div class="p-3 border-b border-white/10 flex justify-between items-center">
                <div>
                    <h2 class="text-lg font-bold text-white">People Nearby</h2>
                    <p class="text-xs text-gray-400" id="nearbyCountText">12 people within 5 km</p>
                </div>
                <select class="text-xs" onchange="filterNearby(this.value)">
                    <option value="5">Within 5 km</option>
                    <option value="10">Within 10 km</option>
                    <option value="20">Within 20 km</option>
                    <option value="50">Within 50 km</option>
                </select>
            </div>
            <div class="nearby-grid" id="nearbyGrid"></div>
        </div>

        <!-- GROUP CHAT SECTION -->
        <div id="section-groups" class="app-section">
            <div class="p-3 border-b border-white/10">
                <h2 class="text-lg font-bold text-white">African Community Groups</h2>
                <p class="text-xs text-gray-400">Join chat rooms by country & region</p>
            </div>
            <div class="p-3" id="groupsContainer"></div>
        </div>

        <!-- MATCHES SECTION -->
        <div id="section-matches" class="app-section">
            <div class="p-3 border-b border-white/10">
                <h2 class="text-lg font-bold text-white">Your Matches</h2>
                <p class="text-xs text-gray-400">People you matched with</p>
            </div>
            <div class="matches-grid" id="matchesGrid"></div>
        </div>

        <!-- MESSAGES SECTION -->
        <div id="section-messages" class="app-section">
            <div class="p-3 border-b border-white/10">
                <h2 class="text-lg font-bold text-white">Messages</h2>
            </div>
            <div class="chat-list" id="chatList"></div>
        </div>

        <!-- AFRICAN MARKET ZONE SECTION -->
        <div id="section-market" class="app-section">
            <div class="market-header">
                <h2 class="text-xl font-bold text-yellow-500">African Market Zone</h2>
                <p class="text-xs text-gray-400">Buy, sell & connect with African vendors</p>
            </div>
            
            <div class="market-search">
                <input type="text" placeholder="Search products, services..." id="marketSearch" onkeyup="searchMarket(this.value)">
                <button class="market-sell-btn" onclick="openCreateAdvert()">
                    <i class="fas fa-plus"></i> Sell
                </button>
            </div>

            <div class="market-categories">
                <div class="market-category active" onclick="filterMarket('all', this)">All Items</div>
                <div class="market-category" onclick="filterMarket('fashion', this)">Fashion</div>
                <div class="market-category" onclick="filterMarket('art', this)">Art & Crafts</div>
                <div class="market-category" onclick="filterMarket('beauty', this)">Beauty</div>
                <div class="market-category" onclick="filterMarket('tech', this)">Tech</div>
                <div class="market-category" onclick="filterMarket('services', this)">Services</div>
            </div>

            <div class="market-grid" id="marketGrid"></div>
        </div>

        <!-- MY ADVERTS SECTION -->
        <div id="section-myadverts" class="app-section">
            <div class="p-3 border-b border-white/10 flex justify-between items-center">
                <div>
                    <h2 class="text-lg font-bold text-white">My Adverts</h2>
                    <p class="text-xs text-gray-400">Manage your listings</p>
                </div>
                <button class="market-sell-btn" onclick="openCreateAdvert()" style="padding: 8px 16px; font-size: 13px;">
                    <i class="fas fa-plus"></i> New
                </button>
            </div>
            <div class="my-adverts-section" id="myAdvertsContainer">
                <p style="text-align: center; color: #888; padding: 40px;">You haven't created any adverts yet.</p>
            </div>
        </div>

        <!-- PROFILE SETTINGS SECTION -->
        <div id="section-profile" class="app-section">
            <input type="file" id="photoUpload" accept="image/*" style="display: none;" onchange="handlePhotoUpload(event)">
            <input type="file" id="avatarUpload" accept="image/*" style="display: none;" onchange="handleAvatarUpload(event)">

            <div class="profile-header">
                <div class="profile-menu-btn" onclick="toggleProfileMenu()">
                    <i class="fas fa-ellipsis-v text-white"></i>
                </div>
                
                <!-- Profile Dropdown Menu -->
                <div class="profile-dropdown" id="profileDropdown">
                    <div class="profile-dropdown-item" onclick="showSection('profile'); toggleProfileMenu();">
                        <i class="fas fa-user"></i>
                        <span>View Profile</span>
                    </div>
                    <div class="profile-dropdown-item" onclick="showProfileSettings(); toggleProfileMenu();">
                        <i class="fas fa-cog"></i>
                        <span>Profile Settings</span>
                    </div>
                    <div class="profile-dropdown-item" onclick="showPrivacySettings(); toggleProfileMenu();">
                        <i class="fas fa-shield-alt"></i>
                        <span>Privacy & Safety</span>
                    </div>
                    <div class="profile-dropdown-divider"></div>
                    <div class="profile-dropdown-item" onclick="showHelp(); toggleProfileMenu();">
                        <i class="fas fa-question-circle"></i>
                        <span>Help & Support</span>
                    </div>
                    <div class="profile-dropdown-item" onclick="showAbout(); toggleProfileMenu();">
                        <i class="fas fa-info-circle"></i>
                        <span>About AfriConnect</span>
                    </div>
                    <div class="profile-dropdown-divider"></div>
                    <div class="profile-dropdown-item" onclick="logout(); toggleProfileMenu();" style="color: #ef4444;">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Logout</span>
                    </div>
                </div>

                <img src="" class="profile-avatar-large" id="userAvatar" onclick="document.getElementById('avatarUpload').click()">
                <div class="avatar-upload-overlay" onclick="document.getElementById('avatarUpload').click()">
                    <i class="fas fa-camera text-2xl text-white"></i>
                </div>
                <button class="absolute top-4 left-4 bg-black/50 p-2 rounded-full hover:bg-yellow-600 transition-colors" onclick="document.getElementById('photoUpload').click()">
                    <i class="fas fa-plus text-white text-sm"></i>
                </button>
            </div>
            
            <div class="settings-section" id="profileSettingsSection">
                <!-- Basic Info -->
                <div class="settings-card">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="text-base font-bold text-yellow-500">About Me</h3>
                        <button onclick="saveProfile()" class="text-xs text-yellow-500 hover:text-yellow-400">
                            <i class="fas fa-check mr-1"></i>Save
                        </button>
                    </div>
                    
                    <div class="mb-3">
                        <label class="text-xs text-gray-500 uppercase tracking-wider">Name</label>
                        <input type="text" id="profileName" class="editable-field" placeholder="Your name">
                    </div>
                    
                    <div class="mb-3">
                        <label class="text-xs text-gray-500 uppercase tracking-wider">Age</label>
                        <input type="number" id="profileAge" class="editable-field" placeholder="Your age">
                    </div>

                    <div class="mb-3">
                        <label class="text-xs text-gray-500 uppercase tracking-wider">Bio</label>
                        <textarea id="profileBio" class="editable-field w-full bg-transparent resize-none" rows="2" placeholder="Tell us about yourself..."></textarea>
                    </div>

                    <div class="mb-3">
                        <label class="text-xs text-gray-500 uppercase tracking-wider">Job Title</label>
                        <input type="text" id="profileJob" class="editable-field" placeholder="Your job">
                    </div>

                    <div class="mb-3">
                        <label class="text-xs text-gray-500 uppercase tracking-wider">Company</label>
                        <input type="text" id="profileCompany" class="editable-field" placeholder="Your company">
                    </div>

                    <div class="mb-3">
                        <label class="text-xs text-gray-500 uppercase tracking-wider">School</label>
                        <input type="text" id="profileSchool" class="editable-field" placeholder="Your school">
                    </div>

                    <!-- Phone Number -->
                    <div class="mb-3">
                        <label class="text-xs text-gray-500 uppercase tracking-wider">Phone Number</label>
                        <div class="flex gap-2 mt-2">
                            <select class="bg-transparent border border-gray-700 rounded-lg px-2 py-2 text-white text-xs" style="width: 70px;">
                                <option value="+234">üá≥üá¨ +234</option>
                                <option value="+233">üá¨üá≠ +233</option>
                                <option value="+254">üá∞üá™ +254</option>
                                <option value="+27">üáøüá¶ +27</option>
                                <option value="+255">üáπüáø +255</option>
                            </select>
                            <input type="tel" id="profilePhone" class="phone-input flex-1 text-sm" placeholder="801 234 5678">
                        </div>
                        <p class="text-xs text-gray-500 mt-1">Phone is only shown to mutual matches</p>
                    </div>
                </div>

                <!-- Photo Manager -->
                <div class="settings-card">
                    <h3 class="text-base font-bold text-yellow-500 mb-3">Photos</h3>
                    <p class="text-xs text-gray-400 mb-2">Tap + to add, tap √ó to remove. First photo is your main photo.</p>
                    <div class="photo-grid" id="photoGrid"></div>
                </div>

                <!-- Gender & Orientation -->
                <div class="settings-card">
                    <h3 class="text-base font-bold text-yellow-500 mb-3">Gender</h3>
                    <div class="gender-options" id="genderOptions">
                        <div class="gender-option selected" onclick="selectGender(this, 'woman')">Woman</div>
                        <div class="gender-option" onclick="selectGender(this, 'man')">Man</div>
                        <div class="gender-option" onclick="selectGender(this, 'non-binary')">Non-binary</div>
                    </div>

                    <h3 class="text-base font-bold text-yellow-500 mb-3 mt-4">Show Me</h3>
                    <div class="setting-item">
                        <span class="text-sm">Looking for</span>
                        <select id="lookingFor" onchange="updateSetting('lookingFor', this.value)" class="text-xs">
                            <option value="men">Men</option>
                            <option value="women">Women</option>
                            <option value="everyone" selected>Everyone</option>
                        </select>
                    </div>
                </div>

                <!-- Discovery Settings -->
                <div class="settings-card">
                    <h3 class="text-base font-bold text-yellow-500 mb-3">Discovery Settings</h3>
                    
                    <div class="setting-item flex-col items-start gap-2">
                        <div class="flex justify-between w-full">
                            <span class="text-sm">Maximum Distance</span>
                            <span class="slider-value" id="distanceValue">50 km</span>
                        </div>
                        <div class="range-slider">
                            <input type="range" min="1" max="100" value="50" id="distanceSlider" oninput="updateDistance(this.value)">
                        </div>
                    </div>

                    <div class="setting-item flex-col items-start gap-2">
                        <div class="flex justify-between w-full">
                            <span class="text-sm">Age Range</span>
                            <span class="slider-value" id="ageValue">22 - 30</span>
                        </div>
                        <div class="dual-range">
                            <input type="range" min="18" max="80" value="22" id="ageMin" oninput="updateAgeRange()">
                            <input type="range" min="18" max="80" value="30" id="ageMax" oninput="updateAgeRange()">
                        </div>
                    </div>

                    <div class="setting-item mt-3">
                        <span class="text-sm">Show me on AfriConnect</span>
                        <div class="toggle-switch active" id="showMeToggle" onclick="this.classList.toggle('active')"></div>
                    </div>

                    <div class="setting-item">
                        <span class="text-sm">Appear in Nearby</span>
                        <div class="toggle-switch active" id="nearbyToggle" onclick="this.classList.toggle('active')"></div>
                    </div>
                </div>

                <!-- Notifications -->
                <div class="settings-card">
                    <h3 class="text-base font-bold text-yellow-500 mb-3">Notifications</h3>
                    <div class="setting-item">
                        <span class="text-sm">New Matches</span>
                        <div class="toggle-switch active" onclick="this.classList.toggle('active')"></div>
                    </div>
                    <div class="setting-item">
                        <span class="text-sm">Messages</span>
                        <div class="toggle-switch active" onclick="this.classList.toggle('active')"></div>
                    </div>
                    <div class="setting-item">
                        <span class="text-sm">Push Notifications</span>
                        <div class="toggle-switch active" onclick="this.classList.toggle('active')"></div>
                    </div>
                </div>

                <!-- Account -->
                <div class="settings-card">
                    <h3 class="text-base font-bold text-yellow-500 mb-3">Account</h3>
                    <div class="setting-item cursor-pointer" onclick="logout()">
                        <span class="text-red-400 text-sm">Logout</span>
                        <i class="fas fa-sign-out-alt text-red-400"></i>
                    </div>
                    <div class="setting-item cursor-pointer">
                        <span class="text-red-400 text-sm">Delete Account</span>
                        <i class="fas fa-trash text-red-400"></i>
                    </div>
                </div>

                <div class="h-16"></div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <div class="nav-item active" onclick="showSection('swipe')">
                <i class="fas fa-fire text-lg"></i>
                <span>Discover</span>
            </div>
            <div class="nav-item" onclick="showSection('nearby')">
                <i class="fas fa-map-marker-alt text-lg"></i>
                <span>Nearby</span>
            </div>
            <div class="nav-item" onclick="showSection('matches')">
                <i class="fas fa-heart text-lg"></i>
                <span>Matches</span>
            </div>
            <div class="nav-item" onclick="showSection('messages')">
                <i class="fas fa-comment text-lg"></i>
                <span>Messages</span>
            </div>
        </div>
    </div>

    <!-- CHAT BOX -->
    <div class="chat-box" id="chatBox">
        <div class="chat-header">
            <button onclick="closeChat()" class="text-white hover:text-yellow-400">
                <i class="fas fa-arrow-left text-lg"></i>
            </button>
            <img src="" class="chat-header-avatar" id="chatAvatar" onclick="viewProfileFromChat()">
            <div class="chat-header-info">
                <div class="chat-header-name" id="chatName"></div>
                <div class="chat-header-status" id="chatStatus">Online</div>
            </div>
            <button onclick="viewProfileFromChat()" class="text-gray-400 hover:text-white">
                <i class="fas fa-info-circle text-lg"></i>
            </button>
        </div>
        <div class="chat-messages" id="chatMessages"></div>
        <div class="chat-input-area">
            <button class="text-gray-400 hover:text-yellow-400 text-lg">
                <i class="fas fa-plus-circle"></i>
            </button>
            <input type="text" class="chat-input" id="chatInput" placeholder="Type a message..." onkeypress="handleChatKeypress(event)">
            <button class="chat-send-btn" onclick="sendMessage()">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <!-- GROUP CHAT BOX -->
    <div class="group-chat-box" id="groupChatBox">
        <div class="group-chat-header">
            <button onclick="closeGroupChat()" class="text-white hover:text-yellow-400">
                <i class="fas fa-arrow-left text-lg"></i>
            </button>
            <div class="group-chat-info">
                <div class="group-chat-name" id="groupChatName"></div>
                <div class="group-chat-meta" id="groupChatMeta">Community Chat Room</div>
            </div>
            <div class="group-members-preview" id="groupMembersPreview"></div>
        </div>
        <div class="chat-messages" id="groupChatMessages"></div>
        <div class="chat-input-area">
            <button class="text-gray-400 hover:text-yellow-400 text-lg">
                <i class="fas fa-plus-circle"></i>
            </button>
            <input type="text" class="chat-input" id="groupChatInput" placeholder="Type a message..." onkeypress="handleGroupChatKeypress(event)">
            <button class="chat-send-btn" onclick="sendGroupMessage()">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <!-- MARKET ITEM DETAIL MODAL -->
    <div class="market-detail-modal" id="marketDetailModal">
        <div class="market-detail-content">
            <div class="profile-modal-header">
                <button onclick="closeMarketDetail()" class="w-10 h-10 rounded-full bg-black/50 flex items-center justify-center text-white hover:bg-white/20 transition-colors">
                    <i class="fas fa-arrow-down"></i>
                </button>
                <div class="flex gap-2">
                    <button class="w-10 h-10 rounded-full bg-black/50 flex items-center justify-center text-white hover:bg-white/20 transition-colors">
                        <i class="fas fa-share-alt"></i>
                    </button>
                    <button class="w-10 h-10 rounded-full bg-black/50 flex items-center justify-center text-white hover:bg-white/20 transition-colors">
                        <i class="fas fa-heart"></i>
                    </button>
                </div>
            </div>
            <div id="marketDetailContent"></div>
        </div>
    </div>

    <!-- CREATE ADVERT MODAL -->
    <div class="create-advert-modal" id="createAdvertModal">
        <div class="create-advert-content">
            <div class="create-advert-header">
                <button onclick="closeCreateAdvert()" class="text-white hover:text-yellow-400">
                    <i class="fas fa-arrow-left text-lg"></i>
                </button>
                <h2 class="text-lg font-bold text-white">Create Advert</h2>
            </div>

            <form id="advertForm" onsubmit="submitAdvert(event)">
                <div class="form-group">
                    <label class="form-label">Product Photos</label>
                    <div class="image-upload-area" onclick="document.getElementById('advertImageInput').click()">
                        <i class="fas fa-camera text-2xl text-gray-400 mb-2"></i>
                        <p style="color: #888; font-size: 13px;">Click to upload photos</p>
                        <p style="color: #666; font-size: 11px; margin-top: 3px;">You can add up to 5 photos</p>
                    </div>
                    <input type="file" id="advertImageInput" accept="image/*" multiple style="display: none;" onchange="previewAdvertImages(event)">
                    <div id="advertImagePreview" style="display: flex; gap: 8px; margin-top: 12px; flex-wrap: wrap;"></div>
                </div>

                <div class="form-group">
                    <label class="form-label">Title</label>
                    <input type="text" class="form-input" id="advertTitle" placeholder="What are you selling?" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Category</label>
                    <select class="form-select" id="advertCategory" required>
                        <option value="">Select category</option>
                        <option value="fashion">Fashion</option>
                        <option value="art">Art & Crafts</option>
                        <option value="beauty">Beauty</option>
                        <option value="tech">Tech</option>
                        <option value="services">Services</option>
                        <option value="other">Other</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Price</label>
                    <input type="text" class="form-input" id="advertPrice" placeholder="e.g. ‚Ç¶25,000" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Location</label>
                    <input type="text" class="form-input" id="advertLocation" placeholder="e.g. Lagos, Nigeria" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Condition</label>
                    <select class="form-select" id="advertCondition" required>
                        <option value="New">New</option>
                        <option value="Used - Like New">Used - Like New</option>
                        <option value="Used - Good">Used - Good</option>
                        <option value="Used - Fair">Used - Fair</option>
                        <option value="Service">Service</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea class="form-textarea" id="advertDescription" placeholder="Describe your product or service..." required></textarea>
                </div>

                <button type="submit" class="submit-advert-btn">
                    <i class="fas fa-check"></i> Post Advert
                </button>
            </form>
        </div>
    </div>

    <!-- PROFILE DETAIL MODAL -->
    <div class="profile-modal" id="profileModal">
        <div class="profile-modal-header">
            <button onclick="closeProfileModal()" class="w-10 h-10 rounded-full bg-black/50 flex items-center justify-center text-white hover:bg-white/20 transition-colors">
                <i class="fas fa-arrow-down"></i>
            </button>
            <div class="flex gap-2">
                <button class="w-10 h-10 rounded-full bg-black/50 flex items-center justify-center text-white hover:bg-white/20 transition-colors">
                    <i class="fas fa-share-alt"></i>
                </button>
                <button class="w-10 h-10 rounded-full bg-black/50 flex items-center justify-center text-white hover:bg-white/20 transition-colors">
                    <i class="fas fa-ellipsis-v"></i>
                </button>
            </div>
        </div>
        
        <div class="profile-modal-content" id="profileModalContent"></div>

        <div class="action-bar" id="profileModalActions"></div>
    </div>

    <!-- Notification Toast -->
    <div class="toast" id="toast">It's a Match! üéâ</div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getDatabase, ref, set, get, onValue, push, update, child } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

        // =============================================
        // PASTE YOUR FIREBASE CONFIG HERE
        // Go to https://console.firebase.google.com
        // Create a project ‚Üí Add Web App ‚Üí Copy config
        // =============================================
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT.firebaseapp.com",
            databaseURL: "https://YOUR_PROJECT-default-rtdb.firebaseio.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // Expose DB helpers globally so script.js can use them
        window._db = db;
        window._dbRef = ref;
        window._dbSet = set;
        window._dbGet = get;
        window._dbOnValue = onValue;
        window._dbPush = push;
        window._dbUpdate = update;
        window._dbChild = child;
        window._firebaseReady = true;

        // =============================================
        // CLEAR ALL FIREBASE USER ACCOUNTS
        // Removes all registered accounts from the database
        // =============================================
        async function clearAllFirebaseAccounts() {
            try {
                await set(ref(db, 'users'), null);
                console.log('‚úÖ All Firebase user accounts cleared');
            } catch (err) {
                console.warn('Could not clear Firebase accounts:', err);
            }
        }
        clearAllFirebaseAccounts();

        // Dispatch event so script.js knows Firebase is loaded
        window.dispatchEvent(new Event('firebaseReady'));
    </script>

    <!-- Your JavaScript File -->
    <script src="script.js"></script>
</body>
</html>